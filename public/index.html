<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#00a884">
  <meta name="description" content="ConnectFlow Messenger - تطبيق مراسلة متكامل">
  <title>ConnectFlow Messenger</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <div id="app">
    <!-- شاشة البداية -->
    <div id="splash-screen" class="splash-screen">
      <div class="splash-content">
        <div class="splash-logo">
          <svg viewBox="0 0 90 90" width="180" height="180">
            <defs>
              <linearGradient id="greenGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#25D366"/>
                <stop offset="100%" style="stop-color:#128C7E"/>
              </linearGradient>
            </defs>
            <path fill="url(#greenGradient)" d="M90 45c0 24.9-20.1 45-45 45S0 69.9 0 45 20.1 0 45 0s45 20.1 45 45z"/>
            <path fill="#fff" d="M67.5 28.5c-3.6-.3-7.3-.3-10.9 0l-3.6.9c-1.5.4-3 .9-4.5 1.5-1.3.5-2.5 1.1-3.6 1.9-1 .7-1.9 1.5-2.7 2.4-1.5 1.8-2.4 4.1-2.4 6.7v33.1c0 2.6.9 4.9 2.4 6.7.8.9 1.7 1.7 2.7 2.4 1.1.8 2.3 1.4 3.6 1.9 1.5.6 3 1.1 4.5 1.5l3.6.9c3.6.3 7.3.3 10.9 0l3.6-.9c1.5-.4 3-.9 4.5-1.5 1.3-.5 2.5-1.1 3.6-1.9 1-.7 1.9-1.5 2.7-2.4 1.5-1.8 2.4-4.1 2.4-6.7V40.5c0-2.6-.9-4.9-2.4-6.7-.8-.9-1.7-1.7-2.7-2.4-1.1-.8-2.3-1.4-3.6-1.9-1.5-.6-3-1.1-4.5-1.5l-3.6-.9z"/>
          </svg>
        </div>
        <h1>ConnectFlow</h1>
        <p>Messenger</p>
      </div>
    </div>

    <!-- شاشة المصادقة -->
    <div id="auth-screen" class="auth-screen hidden">
      <div class="auth-container">
        <div class="auth-header">
          <div class="auth-logo">
            <svg viewBox="0 0 90 90" width="100" height="100">
              <defs>
                <linearGradient id="greenGradient2" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:#25D366"/>
                  <stop offset="100%" style="stop-color:#128C7E"/>
                </linearGradient>
              </defs>
              <path fill="url(#greenGradient2)" d="M90 45c0 24.9-20.1 45-45 45S0 69.9 0 45 20.1 0 45 0s45 20.1 45 45z"/>
            </svg>
          </div>
          <h2>مرحباً بك في ConnectFlow</h2>
          <p>قم بتسجيل الدخول للمتابعة</p>
        </div>

        <div class="auth-tabs">
          <button class="auth-tab active" data-tab="login">تسجيل الدخول</button>
          <button class="auth-tab" data-tab="register">إنشاء حساب</button>
        </div>

        <!-- نموذج تسجيل الدخول -->
        <form id="login-form" class="auth-form active">
          <div class="input-group">
            <i class="fas fa-user"></i>
            <input type="text" id="login-username" placeholder="اسم المستخدم" required>
          </div>
          <div class="input-group">
            <i class="fas fa-lock"></i>
            <input type="password" id="login-password" placeholder="كلمة المرور" required>
            <button type="button" class="toggle-password" data-target="login-password">
              <i class="fas fa-eye"></i>
            </button>
          </div>
          <button type="submit" class="btn-primary">
            <span>تسجيل الدخول</span>
            <i class="fas fa-sign-in-alt"></i>
          </button>
          <p class="auth-error" id="login-error"></p>
        </form>

        <!-- نموذج إنشاء حساب -->
        <form id="register-form" class="auth-form">
          <div class="input-group">
            <i class="fas fa-user-plus"></i>
            <input type="text" id="register-username" placeholder="اسم المستخدم (3-20 حرف)" required minlength="3" maxlength="20">
          </div>
          <div class="input-group">
            <i class="fas fa-lock"></i>
            <input type="password" id="register-password" placeholder="كلمة المرور (4 أحرف على الأقل)" required minlength="4">
            <button type="button" class="toggle-password" data-target="register-password">
              <i class="fas fa-eye"></i>
            </button>
          </div>
          <div class="input-group">
            <i class="fas fa-lock"></i>
            <input type="password" id="register-confirm" placeholder="تأكيد كلمة المرور" required>
            <button type="button" class="toggle-password" data-target="register-confirm">
              <i class="fas fa-eye"></i>
            </button>
          </div>
          <button type="submit" class="btn-primary">
            <span>إنشاء حساب</span>
            <i class="fas fa-user-plus"></i>
          </button>
          <p class="auth-error" id="register-error"></p>
        </form>
      </div>
    </div>

    <!-- الشاشة الرئيسية -->
    <div id="main-screen" class="main-screen hidden">
      <!-- الرأس العلوي -->
      <header class="main-header">
        <div class="header-content">
          <div class="header-tabs">
            <button class="header-tab active" data-view="chats">
              <i class="fas fa-comment-alt"></i>
              <span>الدردشات</span>
            </button>
            <button class="header-tab" data-view="status">
              <i class="fas fa-circle-notch"></i>
              <span>الحالات</span>
            </button>
            <button class="header-tab" data-view="calls">
              <i class="fas fa-phone-alt"></i>
              <span>المكالمات</span>
            </button>
          </div>
          <button class="header-menu-btn" id="header-menu-btn">
            <i class="fas fa-ellipsis-v"></i>
          </button>
        </div>
      </header>

      <!-- القائمة المنسدلة -->
      <div class="dropdown-menu" id="dropdown-menu">
        <div class="dropdown-backdrop" id="dropdown-backdrop"></div>
        <div class="dropdown-content">
          <div class="dropdown-item" id="dropdown-new-group">
            <i class="fas fa-users"></i>
            <span>مجموعة جديدة</span>
          </div>
          <div class="dropdown-item" id="dropdown-settings">
            <i class="fas fa-cog"></i>
            <span>الإعدادات</span>
          </div>
          <div class="dropdown-divider"></div>
          <div class="dropdown-item" id="dropdown-logout">
            <i class="fas fa-sign-out-alt"></i>
            <span>تسجيل الخروج</span>
          </div>
        </div>
      </div>

      <!-- المحتوى الرئيسي -->
      <main class="main-content">
        <!-- عرض الدردشات -->
        <div class="content-view active" id="chats-view">
          <div class="search-bar">
            <div class="search-input-container">
              <button class="search-back-btn">
                <i class="fas fa-arrow-right"></i>
              </button>
              <i class="fas fa-search"></i>
              <input type="text" id="chat-search" placeholder="بحث...">
              <button class="search-clear-btn">
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>

          <div class="chats-list" id="chats-list">
            <!-- الدردشات تظهر هنا -->
          </div>

          <!-- زر الإضافة العائم -->
          <div class="fab-container">
            <button class="fab main-fab" id="main-fab">
              <i class="fas fa-plus"></i>
            </button>
            <div class="fab-options">
              <button class="fab-option" id="fab-new-chat" title="محادثة جديدة">
                <i class="fas fa-comment-medical"></i>
              </button>
              <button class="fab-option" id="fab-new-group" title="مجموعة جديدة">
                <i class="fas fa-users"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- عرض الحالات -->
        <div class="content-view" id="status-view">
          <div class="status-list" id="status-list">
            <!-- الحالات تظهر هنا -->
          </div>
        </div>

        <!-- عرض المكالمات -->
        <div class="content-view" id="calls-view">
          <div class="calls-list" id="calls-list">
            <!-- المكالمات تظهر هنا -->
          </div>
        </div>
      </main>

      <!-- لوحة محادثة جديدة -->
      <div class="new-chat-panel hidden" id="new-chat-panel">
        <div class="panel-header">
          <button class="panel-close" id="close-new-chat">
            <i class="fas fa-arrow-right"></i>
          </button>
          <h3>محادثة جديدة</h3>
        </div>
        <div class="panel-search">
          <i class="fas fa-search"></i>
          <input type="text" id="new-chat-search" placeholder="ابحث عن اسم...">
        </div>
        <div class="panel-content">
          <div class="new-group-section" id="create-new-group-btn">
            <div class="section-icon">
              <i class="fas fa-users"></i>
            </div>
            <span>إنشاء مجموعة جديدة</span>
          </div>
          <div class="contacts-section">
            <h4>جهات الاتصال</h4>
            <div class="contacts-list" id="new-chat-contacts">
              <!-- جهات الاتصال تظهر هنا -->
            </div>
          </div>
        </div>
      </div>

      <!-- نافذة الدردشة -->
      <div class="chat-window hidden" id="chat-window">
        <div class="chat-header">
          <button class="chat-back-btn" id="chat-back">
            <i class="fas fa-arrow-right"></i>
          </button>
          <div class="chat-user-info" id="chat-user-info">
            <!-- معلومات المستخدم تظهر هنا -->
          </div>
          <div class="chat-actions">
            <button class="chat-action-btn" id="chat-video-call" title="مكالمة فيديو">
              <i class="fas fa-video"></i>
            </button>
            <button class="chat-action-btn" id="chat-voice-call" title="مكالمة صوتية">
              <i class="fas fa-phone-alt"></i>
            </button>
            <button class="chat-action-btn" id="chat-more" title="المزيد">
              <i class="fas fa-ellipsis-v"></i>
            </button>
          </div>
        </div>

        <div class="chat-content" id="chat-content">
          <!-- الرسائل تظهر هنا -->
        </div>

        <div class="typing-indicator hidden" id="typing-indicator">
          <span>جاري الكتابة</span>
          <div class="typing-dots">
            <span></span>
            <span></span>
            <span></span>
          </div>
        </div>

        <div class="reply-preview hidden" id="reply-preview">
          <i class="fas fa-reply"></i>
          <div class="reply-preview-text">
            <span class="reply-sender"></span>
            <span class="reply-content"></span>
          </div>
          <button class="reply-preview-close" id="reply-preview-close">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <div class="chat-input-area">
          <div class="input-actions">
            <button class="input-action-btn" id="emoji-btn">
              <i class="far fa-smile"></i>
            </button>
            <button class="input-action-btn" id="attach-btn">
              <i class="fas fa-paperclip"></i>
            </button>
          </div>
          <div class="message-input-container">
            <textarea id="message-input" placeholder="اكتب رسالة..." rows="1"></textarea>
            <div class="input-buttons">
              <button class="input-btn" id="mic-btn">
                <i class="fas fa-microphone"></i>
              </button>
              <button class="input-btn send-btn hidden" id="send-btn">
                <i class="fas fa-paper-plane"></i>
              </button>
            </div>
          </div>
          <div class="input-actions">
            <button class="input-action-btn" id="camera-btn">
              <i class="fas fa-camera"></i>
            </button>
          </div>
        </div>

        <!-- لوحة الرموز التعبيرية -->
        <div class="emoji-panel hidden" id="emoji-panel"></div>

        <!-- لوحة المرفقات -->
        <div class="attach-panel hidden" id="attach-panel">
          <div class="attach-options">
            <button class="attach-option" data-type="document">
              <div class="attach-icon">
                <i class="fas fa-file"></i>
              </div>
              <span>مستند</span>
            </button>
            <button class="attach-option" data-type="camera">
              <div class="attach-icon">
                <i class="fas fa-camera"></i>
              </div>
              <span>كاميرا</span>
            </button>
            <button class="attach-option" data-type="gallery">
              <div class="attach-icon">
                <i class="fas fa-images"></i>
              </div>
              <span>مكتبة الصور</span>
            </button>
            <button class="attach-option" data-type="audio">
              <div class="attach-icon">
                <i class="fas fa-music"></i>
              </div>
              <span>ملف صوتي</span>
            </button>
          </div>
        </div>

        <!-- لوحة تسجيل الصوت -->
        <div class="voice-record-panel hidden" id="voice-record-panel">
          <div class="record-timer">
            <i class="fas fa-microphone"></i>
            <span id="record-timer">00:00</span>
          </div>
          <div class="record-waves">
            <div class="wave"></div>
            <div class="wave"></div>
            <div class="wave"></div>
            <div class="wave"></div>
            <div class="wave"></div>
          </div>
          <div class="record-actions">
            <button class="record-action-btn" id="record-close">
              <i class="fas fa-times"></i>
            </button>
            <button class="record-action-btn send-record" id="send-voice">
              <i class="fas fa-paper-plane"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- لوحة الإعدادات -->
      <div class="settings-panel hidden" id="settings-panel">
        <div class="panel-header">
          <button class="panel-close" id="close-settings">
            <i class="fas fa-arrow-right"></i>
          </button>
          <h3>الإعدادات</h3>
        </div>
        <div class="settings-content">
          <div class="settings-profile">
            <div class="settings-avatar">
              <img id="settings-avatar" src="/avatars/default.png" alt="">
              <button class="change-avatar-btn" id="change-settings-avatar">
                <i class="fas fa-camera"></i>
              </button>
            </div>
            <div class="settings-name">
              <span id="settings-name">المستخدم</span>
              <span id="settings-status">متصل الآن</span>
            </div>
          </div>
          <div class="settings-section">
            <div class="settings-item">
              <i class="fas fa-moon"></i>
              <div class="settings-item-content">
                <span>الوضع الداكن</span>
              </div>
              <label class="switch">
                <input type="checkbox" id="dark-mode-toggle">
                <span class="slider"></span>
              </label>
            </div>
            <div class="settings-item" id="privacy-settings">
              <i class="fas fa-lock"></i>
              <div class="settings-item-content">
                <span>الخصوصية</span>
              </div>
              <i class="fas fa-chevron-left settings-arrow"></i>
            </div>
            <div class="settings-item">
              <i class="fas fa-info-circle"></i>
              <div class="settings-item-content">
                <span>حول التطبيق</span>
              </div>
              <i class="fas fa-chevron-left settings-arrow"></i>
            </div>
          </div>
        </div>
      </div>

      <!-- لوحة إنشاء مجموعة -->
      <div class="new-group-panel hidden" id="new-group-panel">
        <div class="panel-header">
          <button class="panel-close" id="close-new-group">
            <i class="fas fa-arrow-right"></i>
          </button>
          <h3>إنشاء مجموعة جديدة</h3>
          <button class="panel-action" id="create-group-action">إنشاء</button>
        </div>
        <div class="new-group-content">
          <div class="group-icon-section">
            <div class="group-icon" id="group-icon">
              <i class="fas fa-users"></i>
            </div>
          </div>
          <div class="group-name-input">
            <input type="text" id="group-name" placeholder="اسم المجموعة">
          </div>
          <div class="group-participants">
            <h4>المشاركون</h4>
            <div class="participants-list" id="group-participants">
              <!-- المشاركون يضافون هنا -->
            </div>
            <button class="add-participant-btn" id="add-group-participant">
              <i class="fas fa-plus"></i>
              <span>إضافة مشارك</span>
            </button>
          </div>
        </div>
      </div>

      <!-- قائمة السياق للرسائل -->
      <div class="context-menu hidden" id="context-menu">
        <div class="context-menu-backdrop" id="context-backdrop"></div>
        <div class="context-menu-content">
          <div class="context-item" id="context-reply">
            <i class="fas fa-reply"></i>
            <span>الرد</span>
          </div>
          <div class="context-item" id="context-copy">
            <i class="fas fa-copy"></i>
            <span>نسخ</span>
          </div>
          <div class="context-divider"></div>
          <div class="context-item danger" id="context-delete">
            <i class="fas fa-trash"></i>
            <span>حذف</span>
          </div>
        </div>
      </div>

      <!-- مربع تأكيد الحذف -->
      <div class="confirm-dialog hidden" id="confirm-dialog">
        <div class="confirm-backdrop"></div>
        <div class="confirm-content">
          <h3 id="confirm-title">تأكيد الحذف</h3>
          <p id="confirm-message">هل أنت متأكد من حذف هذه الرسالة؟</p>
          <div class="confirm-actions">
            <button class="confirm-btn cancel" id="confirm-cancel">إلغاء</button>
            <button class="confirm-btn danger" id="confirm-ok">حذف</button>
          </div>
        </div>
      </div>

      <!-- عارض الوسائط -->
      <div class="media-viewer hidden" id="media-viewer">
        <div class="media-viewer-header">
          <button class="media-close" id="media-close">
            <i class="fas fa-times"></i>
          </button>
          <span class="media-title" id="media-title">الصورة</span>
        </div>
        <div class="media-viewer-content">
          <img id="media-image" class="hidden" src="" alt="">
          <video id="media-video" class="hidden" controls></video>
        </div>
      </div>
    </div>

    <!-- ملفات الإدخال المخفية -->
    <input type="file" id="image-input" accept="image/*" multiple hidden>
    <input type="file" id="audio-input" accept="audio/*" hidden>
    <input type="file" id="document-input" accept=".pdf,.doc,.docx,.txt" hidden>
    <input type="file" id="avatar-input" accept="image/*" hidden>
    <input type="file" id="camera-input" accept="image/*" capture="environment" hidden>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/js/app.js"></script>
</body>
</html>
